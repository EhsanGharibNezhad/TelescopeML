<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Train a Regression ConvNN Model Using BOHB Tuned Hyperparameters &mdash; TelescopeML 0.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            TelescopeML
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledgebase.html">KnowledgeBase</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ehsangharibnezhad">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">What to Cite</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TelescopeML</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Train a Regression ConvNN Model Using BOHB Tuned Hyperparameters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/store/Train_CNN_Model.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Train-a-Regression-ConvNN-Model-Using-BOHB-Tuned-Hyperparameters">
<h1>Train a Regression ConvNN Model Using BOHB Tuned Hyperparameters<a class="headerlink" href="#Train-a-Regression-ConvNN-Model-Using-BOHB-Tuned-Hyperparameters" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">TelescopeML.DeepTrainer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TelescopeML.DeepBuilder</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TelescopeML.Predictor</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">TelescopeML.IO_utils</span> <span class="kn">import</span> <span class="n">load_or_dump_trained_model_CNN</span>
<span class="kn">from</span> <span class="nn">TelescopeML.StatVisAnalyzer</span> <span class="kn">import</span> <span class="n">regression_report</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-1:-Load-the-training-dataset-(syntheric-spectra)">
<h1>Step 1: Load the training dataset (syntheric spectra)<a class="headerlink" href="#Step-1:-Load-the-training-dataset-(syntheric-spectra)" title="Permalink to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># original trainign dataset astronomers use to predict the parameters of the telescope brown dwarf spectra</span>

<span class="n">train_BD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../datasets/browndwarf_R100_v4_newWL_v2.csv.bz2&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;bz2&#39;</span><span class="p">)</span>
<span class="n">train_BD</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>temperature</th>
      <th>c_o_ratio</th>
      <th>metallicity</th>
      <th>2.512</th>
      <th>2.487</th>
      <th>2.462</th>
      <th>2.438</th>
      <th>2.413</th>
      <th>2.389</th>
      <th>...</th>
      <th>0.971</th>
      <th>0.962</th>
      <th>0.952</th>
      <th>0.943</th>
      <th>0.933</th>
      <th>0.924</th>
      <th>0.915</th>
      <th>0.906</th>
      <th>0.897</th>
      <th>is_augmented</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-1.0</td>
      <td>9.103045e-08</td>
      <td>1.181658e-07</td>
      <td>1.307868e-07</td>
      <td>1.269229e-07</td>
      <td>1.159179e-07</td>
      <td>8.925110e-08</td>
      <td>...</td>
      <td>9.640859e-08</td>
      <td>7.612550e-08</td>
      <td>6.901364e-08</td>
      <td>6.247359e-08</td>
      <td>4.112384e-08</td>
      <td>5.127995e-08</td>
      <td>4.897355e-08</td>
      <td>4.087795e-08</td>
      <td>2.791689e-08</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-0.7</td>
      <td>9.103045e-08</td>
      <td>1.181658e-07</td>
      <td>1.307868e-07</td>
      <td>1.269229e-07</td>
      <td>1.159179e-07</td>
      <td>8.925110e-08</td>
      <td>...</td>
      <td>9.640859e-08</td>
      <td>7.612550e-08</td>
      <td>6.901364e-08</td>
      <td>6.247359e-08</td>
      <td>4.112384e-08</td>
      <td>5.127995e-08</td>
      <td>4.897355e-08</td>
      <td>4.087795e-08</td>
      <td>2.791689e-08</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-0.5</td>
      <td>9.103045e-08</td>
      <td>1.181658e-07</td>
      <td>1.307868e-07</td>
      <td>1.269229e-07</td>
      <td>1.159179e-07</td>
      <td>8.925110e-08</td>
      <td>...</td>
      <td>9.640859e-08</td>
      <td>7.612550e-08</td>
      <td>6.901364e-08</td>
      <td>6.247359e-08</td>
      <td>4.112384e-08</td>
      <td>5.127995e-08</td>
      <td>4.897355e-08</td>
      <td>4.087795e-08</td>
      <td>2.791689e-08</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 109 columns</p>
</div></div>
</div>
<section id="Check-the-columns">
<h2>Check the columns<a class="headerlink" href="#Check-the-columns" title="Permalink to this heading"></a></h2>
<p>note: one of the columns, <em>is_augmented</em>, is indicating wheter this is a native dataset or an augmented one. For now, we don’t need it so drop it, but all modules will take this into account!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;c_o_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;metallicity&#39;</span><span class="p">]</span>
<span class="n">train_BD</span><span class="p">[</span><span class="n">target_features</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>temperature</th>
      <th>c_o_ratio</th>
      <th>metallicity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-0.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-0.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>-0.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1100</td>
      <td>0.25</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_features_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train_BD</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_features</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;is_augmented&#39;</span><span class="p">]]</span>
<span class="n">training_features_labels</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;2.512&#39;, &#39;2.487&#39;, &#39;2.462&#39;, &#39;2.438&#39;, &#39;2.413&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_features_wl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train_BD</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_features</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;is_augmented&#39;</span><span class="p">]]</span>
<span class="n">training_features_wl</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.512, 2.487, 2.462, 2.438, 2.413]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../datasets/wl.csv&#39;</span><span class="p">)</span>
<span class="n">wl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.511960</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.486966</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.462220</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="Prepare-feature-variables-(X)-and-targets-(y)">
<h3>Prepare feature variables (X) and targets (y)<a class="headerlink" href="#Prepare-feature-variables-(X)-and-targets-(y)" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to assure we are only training the module with the native non-augmented BD training dataset</span>
<span class="n">train_BD</span> <span class="o">=</span> <span class="n">train_BD</span><span class="p">[</span><span class="n">train_BD</span><span class="p">[</span><span class="s1">&#39;is_augmented&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;no&#39;</span><span class="p">])]</span>


<span class="c1"># Training feature variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">train_BD</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">,</span>
             <span class="s1">&#39;temperature&#39;</span><span class="p">,</span>
             <span class="s1">&#39;c_o_ratio&#39;</span><span class="p">,</span>
             <span class="s1">&#39;metallicity&#39;</span><span class="p">,</span>
             <span class="s1">&#39;is_augmented&#39;</span><span class="p">])</span><span class="c1">#.astype(np.float32)</span>


<span class="c1"># Target feature variables</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_BD</span><span class="p">[[</span><span class="s1">&#39;gravity&#39;</span><span class="p">,</span> <span class="s1">&#39;c_o_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;metallicity&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="p">]]</span><span class="c1">#.astype(np.float32)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gravity</th>
      <th>c_o_ratio</th>
      <th>metallicity</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>0.25</td>
      <td>-1.0</td>
      <td>3.041393</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>0.25</td>
      <td>-0.7</td>
      <td>3.041393</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>0.25</td>
      <td>-0.5</td>
      <td>3.041393</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.25</td>
      <td>-0.3</td>
      <td>3.041393</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>3.041393</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
</section>
</section>
</section>
<section id="Step-2:-Build-the-CNN-model-/-Data-processing">
<h1>Step 2: Build the CNN model / Data processing<a class="headerlink" href="#Step-2:-Build-the-CNN-model-/-Data-processing" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instintiate BuildCNN class</span>
<span class="n">build_cnn_regression</span> <span class="o">=</span> <span class="n">BuildRegressorCNN</span><span class="p">(</span>
                             <span class="n">feature_values</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
                             <span class="n">feature_names</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                             <span class="n">target_values</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
                             <span class="n">target_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gravity&#39;</span><span class="p">,</span> <span class="s1">&#39;c_o_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;metallicity&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
                             <span class="n">is_tuned</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span>
                             <span class="n">param_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">spectral_resolution</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                             <span class="n">is_feature_improved</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span>
                             <span class="n">is_augmented</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span>
                             <span class="n">ml_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">ml_model_str</span><span class="o">=</span><span class="s1">&#39;CNN&#39;</span><span class="p">,</span>
                                <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">split_train_validation_test</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                                 <span class="n">val_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                                 <span class="n">random_state_</span><span class="o">=</span><span class="mi">100</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale the X features using MinMax Scaler</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">standardize_X_row_wise</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">plot_boxplot_scaled_features</span><span class="p">(</span><span class="n">scaled_feature</span><span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_standardized_rowwise</span><span class="p">,</span>
                                                  <span class="n">xticks_list</span> <span class="o">=</span> <span class="n">training_features_labels</span><span class="p">,</span>
                                                  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Scaled main 104 Features&#39;</span><span class="p">,</span>
                                                  <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                                    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_19_0.png" src="../../_images/tutorials_store_Train_CNN_Model_19_0.png" />
</div>
</div>
<section id="Scale-y-features---ColumnWise">
<h2>Scale y features - ColumnWise<a class="headerlink" href="#Scale-y-features---ColumnWise" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardize the y features using Standard Scaler</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">standardize_y_column_wise</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">plot_boxplot_scaled_features</span><span class="p">(</span><span class="n">scaled_feature</span><span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">,</span>
                                                  <span class="n">xticks_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;$\log g$&#39;</span><span class="p">,</span> <span class="s1">&#39;T$_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;C/O ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;[M/E]&#39;</span><span class="p">],</span>
                                                  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Scaled target Features - ColumnWise&#39;</span><span class="p">,</span>
                                                  <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                                    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_22_0.png" src="../../_images/tutorials_store_Train_CNN_Model_22_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># build_cnn_regression.y_train_standardized_columnwise</span>
</pre></div>
</div>
</div>
</section>
<section id="Feature-engeenering:-Take-Min-and-Max-of-each-row-(BD-spectra)">
<h2>Feature engeenering: Take Min and Max of each row (BD spectra)<a class="headerlink" href="#Feature-engeenering:-Take-Min-and-Max-of-each-row-(BD-spectra)" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_min</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_max</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># validation</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_min</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_max</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># test</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_min</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_max</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_MinMax_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_min</span><span class="p">,</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">df_MinMax_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_min</span><span class="p">,</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">df_MinMax_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_min</span><span class="p">,</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_max</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_MinMax_train</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;max&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_MinMax_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.984493e-18</td>
      <td>4.560593e-11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.833671e-15</td>
      <td>2.317328e-09</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.870361e-14</td>
      <td>5.564836e-09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.696652e-19</td>
      <td>5.071436e-11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.321553e-10</td>
      <td>1.636513e-07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<hr class="docutils" />
</section>
<section id="Scale-Min-Max-features---ColumnWise">
<h2>Scale Min Max features - ColumnWise<a class="headerlink" href="#Scale-Min-Max-features---ColumnWise" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">standardize_X_column_wise</span><span class="p">(</span>
                                                <span class="n">X_train</span> <span class="o">=</span> <span class="n">df_MinMax_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                                <span class="n">X_val</span>   <span class="o">=</span> <span class="n">df_MinMax_val</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                                <span class="n">X_test</span>  <span class="o">=</span> <span class="n">df_MinMax_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                                <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">plot_boxplot_scaled_features</span><span class="p">(</span><span class="n">scaled_feature</span><span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_standardized_columnwise</span><span class="p">,</span>
                                                  <span class="n">xticks_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;Min&#39;</span><span class="p">,</span><span class="s1">&#39;Max&#39;</span><span class="p">],</span>
                                                  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Scaled Min Max Features - ColumnWise&#39;</span><span class="p">,</span>
                                                  <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                                    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_32_0.png" src="../../_images/tutorials_store_Train_CNN_Model_32_0.png" />
</div>
</div>
</section>
</section>
<section id="Step-3:-Train-CNN-model">
<h1>Step 3: Train CNN model<a class="headerlink" href="#Step-3:-Train-CNN-model" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_cnn_model</span> <span class="o">=</span> <span class="n">TrainRegressorCNN</span><span class="p">(</span>
            <span class="c1"># input dataset: StandardScaled instances</span>
            <span class="n">X1_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_standardized_rowwise</span><span class="p">,</span>
            <span class="n">X1_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_standardized_rowwise</span><span class="p">,</span>
            <span class="n">X1_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_standardized_rowwise</span><span class="p">,</span>

            <span class="c1"># input dataset: Min Max of each instance</span>
            <span class="n">X2_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_standardized_columnwise</span><span class="p">,</span>
            <span class="n">X2_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_val_standardized_columnwise</span><span class="p">,</span>
            <span class="n">X2_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_standardized_columnwise</span><span class="p">,</span>

            <span class="c1"># 1st target</span>
            <span class="n">y1_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y1_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_val_standardized_columnwise</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">y1_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_test_standardized_columnwise</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>

            <span class="c1"># 2nd target</span>
            <span class="n">y2_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">y2_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_val_standardized_columnwise</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">y2_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_test_standardized_columnwise</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>

            <span class="c1"># 3rd target</span>
            <span class="n">y3_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">y3_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_val_standardized_columnwise</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">y3_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_test_standardized_columnwise</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span>

            <span class="c1"># 4th target</span>
            <span class="n">y4_train</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">y4_val</span>   <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_val_standardized_columnwise</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">y4_test</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_test_standardized_columnwise</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;Conv__MaxPooling1D&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s1">&#39;Conv__num_blocks&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s1">&#39;Conv__num_layers_per_block&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
     <span class="s1">&#39;Conv__num_filters&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s1">&#39;Conv__kernel_size&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
     <span class="s1">&#39;FC__NumberLayers&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>

     <span class="s1">&#39;FC1__num_blocks&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s1">&#39;FC1_num_layers_per_block&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s1">&#39;FC1__dropout&#39;</span><span class="p">:</span> <span class="mf">0.09889223768186726</span><span class="p">,</span>
     <span class="s1">&#39;FC1__units&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>

     <span class="s1">&#39;FC2__num_blocks&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s1">&#39;FC2_num_layers_per_block&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
     <span class="s1">&#39;FC2__dropout&#39;</span><span class="p">:</span> <span class="mf">0.0024609140719442646</span><span class="p">,</span>
     <span class="s1">&#39;FC2__units&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>


     <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">4.9946842008422193e-05</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_cnn_model</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">hyperparameters</span> <span class="o">=</span> <span class="n">hyperparameters</span><span class="p">,</span>
                     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-08-11 12:11:35.422940: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;model&#34;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            [(None, 104, 1)]     0
__________________________________________________________________________________________________
Conv__B1_L1 (Conv1D)            (None, 104, 16)      112         input_1[0][0]
__________________________________________________________________________________________________
Conv__B1_L2 (Conv1D)            (None, 104, 64)      6208        Conv__B1_L1[0][0]
__________________________________________________________________________________________________
Conv__B1_L3 (Conv1D)            (None, 104, 144)     55440       Conv__B1_L2[0][0]
__________________________________________________________________________________________________
MaxPool1D__B1_L3 (MaxPooling1D) (None, 52, 144)      0           Conv__B1_L3[0][0]
__________________________________________________________________________________________________
flatten (Flatten)               (None, 7488)         0           MaxPool1D__B1_L3[0][0]
__________________________________________________________________________________________________
FC1__B1_L1 (Dense)              (None, 512)          3834368     flatten[0][0]
__________________________________________________________________________________________________
FC1__B1_L2 (Dense)              (None, 2048)         1050624     FC1__B1_L1[0][0]
__________________________________________________________________________________________________
FC1__B1_L3 (Dense)              (None, 4608)         9441792     FC1__B1_L2[0][0]
__________________________________________________________________________________________________
FC1__B1_L4 (Dense)              (None, 8192)         37756928    FC1__B1_L3[0][0]
__________________________________________________________________________________________________
FC1__Dropout__B1_L4 (Dropout)   (None, 8192)         0           FC1__B1_L4[0][0]
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, 2)]          0
__________________________________________________________________________________________________
Concatenated_Layer (Concatenate (None, 8194)         0           FC1__Dropout__B1_L4[0][0]
                                                                 input_2[0][0]
__________________________________________________________________________________________________
FC2__B1_L1 (Dense)              (None, 256)          2097920     Concatenated_Layer[0][0]
__________________________________________________________________________________________________
FC2__B1_L2 (Dense)              (None, 1024)         263168      FC2__B1_L1[0][0]
__________________________________________________________________________________________________
FC2__Dropout__B1_L2 (Dropout)   (None, 1024)         0           FC2__B1_L2[0][0]
__________________________________________________________________________________________________
gravity (Dense)                 (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
c_o_ratio (Dense)               (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
metallicity (Dense)             (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
temperature (Dense)             (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
==================================================================================================
Total params: 54,510,660
Trainable params: 54,510,660
Non-trainable params: 0
__________________________________________________________________________________________________
None
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span>  <span class="n">train_cnn_model</span><span class="o">.</span><span class="n">fit_cnn_model</span><span class="p">(</span><span class="n">budget</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-08-11 12:11:39.897577: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 57/782 [=&gt;............................] - ETA: 2:28 - loss: 0.8493 - gravity_loss: 0.3313 - c_o_ratio_loss: 0.2397 - metallicity_loss: 0.2298 - temperature_loss: 0.0484 - gravity_mae: 0.6989 - c_o_ratio_mae: 0.5663 - metallicity_mae: 0.5553 - temperature_mae: 0.2095
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [32], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> history, model <span style="color: rgb(98,98,98)">=</span>  <span class="ansi-yellow-bg">train_cnn_model</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit_cnn_model</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">budget</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/RESEARCH/ml/projects/telescopeML_project/telescopeML/TelescopeML/DeepTrainer.py:261</span>, in <span class="ansi-cyan-fg">TrainRegressorCNN.fit_cnn_model</span><span class="ansi-blue-fg">(self, budget)</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span> early_stop <span style="color: rgb(98,98,98)">=</span> EarlyStopping(monitor<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">loss</span><span style="color: rgb(175,0,0)">&#39;</span>, min_delta<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">4e-4</span>, patience<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">50</span>, mode<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">auto</span><span style="color: rgb(175,0,0)">&#39;</span>, \
<span class="ansi-green-intense-fg ansi-bold">    258</span>                            restore_best_weights<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>)
<span class="ansi-green-intense-fg ansi-bold">    260</span> <span style="color: rgb(95,135,135)"># YOU CAN ADD FUNCTION HERE TO ADD NOISE</span>
<span class="ansi-green-fg">--&gt; 261</span> history <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">model</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">X1_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">X2_train</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    262</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y1_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y2_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y3_train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y4_train</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    263</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># self.x_train, self.y_train,</span>
<span class="ansi-green-intense-fg ansi-bold">    264</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">batch_size</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">32</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># config[&#39;batch_size&#39;], # self.batch_size,</span>
<span class="ansi-green-intense-fg ansi-bold">    265</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">validation_data</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    266</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">X1_val</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">X2_val</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y1_val</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y2_val</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y3_val</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">y4_val</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    267</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># validation_split=0.2,</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">epochs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">int</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">budget</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    269</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">verbose</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">callbacks</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">early_stop</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span> <span class="ansi-yellow-bg">                         </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    272</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>model <span style="color: rgb(98,98,98)">=</span> model
<span class="ansi-green-intense-fg ansi-bold">    273</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>history <span style="color: rgb(98,98,98)">=</span> history

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/keras/engine/training.py:1184</span>, in <span class="ansi-cyan-fg">Model.fit</span><span class="ansi-blue-fg">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)</span>
<span class="ansi-green-intense-fg ansi-bold">   1177</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> tf<span style="color: rgb(98,98,98)">.</span>profiler<span style="color: rgb(98,98,98)">.</span>experimental<span style="color: rgb(98,98,98)">.</span>Trace(
<span class="ansi-green-intense-fg ansi-bold">   1178</span>     <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">train</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">   1179</span>     epoch_num<span style="color: rgb(98,98,98)">=</span>epoch,
<span class="ansi-green-intense-fg ansi-bold">   1180</span>     step_num<span style="color: rgb(98,98,98)">=</span>step,
<span class="ansi-green-intense-fg ansi-bold">   1181</span>     batch_size<span style="color: rgb(98,98,98)">=</span>batch_size,
<span class="ansi-green-intense-fg ansi-bold">   1182</span>     _r<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">1</span>):
<span class="ansi-green-intense-fg ansi-bold">   1183</span>   callbacks<span style="color: rgb(98,98,98)">.</span>on_train_batch_begin(step)
<span class="ansi-green-fg">-&gt; 1184</span>   tmp_logs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">train_function</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1185</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> data_handler<span style="color: rgb(98,98,98)">.</span>should_sync:
<span class="ansi-green-intense-fg ansi-bold">   1186</span>     context<span style="color: rgb(98,98,98)">.</span>async_wait()

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py:885</span>, in <span class="ansi-cyan-fg">Function.__call__</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    882</span> compiler <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">xla</span><span style="color: rgb(175,0,0)">&#34;</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_jit_compile <span class="ansi-bold" style="color: rgb(0,135,0)">else</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">nonXla</span><span style="color: rgb(175,0,0)">&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    884</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> OptionalXlaContext(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_jit_compile):
<span class="ansi-green-fg">--&gt; 885</span>   result <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    887</span> new_tracing_count <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>experimental_get_tracing_count()
<span class="ansi-green-intense-fg ansi-bold">    888</span> without_tracing <span style="color: rgb(98,98,98)">=</span> (tracing_count <span style="color: rgb(98,98,98)">==</span> new_tracing_count)

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py:917</span>, in <span class="ansi-cyan-fg">Function._call</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    914</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_lock<span style="color: rgb(98,98,98)">.</span>release()
<span class="ansi-green-intense-fg ansi-bold">    915</span>   <span style="color: rgb(95,135,135)"># In this case we have created variables on the first call, so we run the</span>
<span class="ansi-green-intense-fg ansi-bold">    916</span>   <span style="color: rgb(95,135,135)"># defunned version which is guaranteed to never create variables.</span>
<span class="ansi-green-fg">--&gt; 917</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_stateless_fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>  <span style="color: rgb(95,135,135)"># pylint: disable=not-callable</span>
<span class="ansi-green-intense-fg ansi-bold">    918</span> <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_stateful_fn <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-intense-fg ansi-bold">    919</span>   <span style="color: rgb(95,135,135)"># Release the lock early so that multiple threads can perform the call</span>
<span class="ansi-green-intense-fg ansi-bold">    920</span>   <span style="color: rgb(95,135,135)"># in parallel.</span>
<span class="ansi-green-intense-fg ansi-bold">    921</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_lock<span style="color: rgb(98,98,98)">.</span>release()

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/function.py:3039</span>, in <span class="ansi-cyan-fg">Function.__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   3036</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_lock:
<span class="ansi-green-intense-fg ansi-bold">   3037</span>   (graph_function,
<span class="ansi-green-intense-fg ansi-bold">   3038</span>    filtered_flat_args) <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_maybe_define_function(args, kwargs)
<span class="ansi-green-fg">-&gt; 3039</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">graph_function</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_call_flat</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">   3040</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">filtered_flat_args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">captured_inputs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">graph_function</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">captured_inputs</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/function.py:1963</span>, in <span class="ansi-cyan-fg">ConcreteFunction._call_flat</span><span class="ansi-blue-fg">(self, args, captured_inputs, cancellation_manager)</span>
<span class="ansi-green-intense-fg ansi-bold">   1959</span> possible_gradient_type <span style="color: rgb(98,98,98)">=</span> gradients_util<span style="color: rgb(98,98,98)">.</span>PossibleTapeGradientTypes(args)
<span class="ansi-green-intense-fg ansi-bold">   1960</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> (possible_gradient_type <span style="color: rgb(98,98,98)">==</span> gradients_util<span style="color: rgb(98,98,98)">.</span>POSSIBLE_GRADIENT_TYPES_NONE
<span class="ansi-green-intense-fg ansi-bold">   1961</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> executing_eagerly):
<span class="ansi-green-intense-fg ansi-bold">   1962</span>   <span style="color: rgb(95,135,135)"># No tape is watching; skip to running the function.</span>
<span class="ansi-green-fg">-&gt; 1963</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_build_call_outputs(<span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_inference_function</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">call</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">   1964</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cancellation_manager</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">cancellation_manager</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-intense-fg ansi-bold">   1965</span> forward_backward <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_select_forward_and_backward_functions(
<span class="ansi-green-intense-fg ansi-bold">   1966</span>     args,
<span class="ansi-green-intense-fg ansi-bold">   1967</span>     possible_gradient_type,
<span class="ansi-green-intense-fg ansi-bold">   1968</span>     executing_eagerly)
<span class="ansi-green-intense-fg ansi-bold">   1969</span> forward_function, args_with_tangents <span style="color: rgb(98,98,98)">=</span> forward_backward<span style="color: rgb(98,98,98)">.</span>forward()

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/function.py:591</span>, in <span class="ansi-cyan-fg">_EagerDefinedFunction.call</span><span class="ansi-blue-fg">(self, ctx, args, cancellation_manager)</span>
<span class="ansi-green-intense-fg ansi-bold">    589</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> _InterpolateFunctionError(<span style="color: rgb(0,135,0)">self</span>):
<span class="ansi-green-intense-fg ansi-bold">    590</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> cancellation_manager <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">--&gt; 591</span>     outputs <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-intense-fg ansi-bold">    592</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">str</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">signature</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    593</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_num_outputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    594</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    595</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    596</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    597</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    598</span>     outputs <span style="color: rgb(98,98,98)">=</span> execute<span style="color: rgb(98,98,98)">.</span>execute_with_cancellation(
<span class="ansi-green-intense-fg ansi-bold">    599</span>         <span style="color: rgb(0,135,0)">str</span>(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>signature<span style="color: rgb(98,98,98)">.</span>name),
<span class="ansi-green-intense-fg ansi-bold">    600</span>         num_outputs<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_num_outputs,
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    603</span>         ctx<span style="color: rgb(98,98,98)">=</span>ctx,
<span class="ansi-green-intense-fg ansi-bold">    604</span>         cancellation_manager<span style="color: rgb(98,98,98)">=</span>cancellation_manager)

File <span class="ansi-green-fg">/usr/local/anaconda3/envs/ml/lib/python3.9/site-packages/tensorflow/python/eager/execute.py:59</span>, in <span class="ansi-cyan-fg">quick_execute</span><span class="ansi-blue-fg">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-intense-fg ansi-bold">     58</span>   ctx<span style="color: rgb(98,98,98)">.</span>ensure_initialized()
<span class="ansi-green-fg">---&gt; 59</span>   tensors <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pywrap_tfe</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">TFE_Py_Execute</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_handle</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">device_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">op_name</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     60</span> <span class="ansi-yellow-bg">                                      </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     61</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> core<span style="color: rgb(98,98,98)">.</span>_NotOkStatusException <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-intense-fg ansi-bold">     62</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> name <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">trained_model</span> <span class="o">=</span> <span class="n">model</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">history</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span>
                <span class="n">train_cnn_model</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">to_file</span><span class="o">=</span><span class="s2">&quot;model.png&quot;</span><span class="p">,</span>
                <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">show_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">rankdir</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span>
                <span class="n">expand_nested</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                <span class="n">layer_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="c1">#                 show_layer_activations=False,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) &#39;, &#39;for plot_model/model_to_dot to work.&#39;)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">load_or_dump_trained_model_CNN</span><span class="p">(</span> <span class="n">trained_model</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="p">,</span>
                                                        <span class="n">indicator</span><span class="o">=</span><span class="s1">&#39;Toy_parameters__newbuild_random100_v2_delete&#39;</span><span class="p">,</span>
                                                        <span class="n">load_or_dump</span> <span class="o">=</span> <span class="s1">&#39;dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">load_or_dump_trained_model_CNN</span><span class="p">(</span><span class="n">indicator</span><span class="o">=</span><span class="s1">&#39;Toy_parameters__newbuild_random100_v2_delete&#39;</span><span class="p">,</span>
                                                      <span class="n">load_or_dump</span> <span class="o">=</span> <span class="s1">&#39;load&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">trained_model</span> <span class="o">=</span> <span class="n">loaded_model</span>
<span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">trained_model_history</span> <span class="o">=</span> <span class="n">history</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-4:-Check-Trained-Model">
<h1>Step 4: Check Trained Model<a class="headerlink" href="#Step-4:-Check-Trained-Model" title="Permalink to this heading"></a></h1>
<hr class="docutils" />
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span>
                <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">trained_model</span><span class="p">,</span>
                <span class="c1"># to_file=&quot;model.png&quot;,</span>
                <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">show_dtype</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">rankdir</span><span class="o">=</span><span class="s2">&quot;TB&quot;</span><span class="p">,</span>
                <span class="n">expand_nested</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">dpi</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                <span class="n">layer_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="c1">#                 show_layer_activations=False,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) &#39;, &#39;for plot_model/model_to_dot to work.&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">trained_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;model&#34;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            [(None, 104, 1)]     0
__________________________________________________________________________________________________
Conv__B1_L1 (Conv1D)            (None, 104, 16)      112         input_1[0][0]
__________________________________________________________________________________________________
Conv__B1_L2 (Conv1D)            (None, 104, 64)      6208        Conv__B1_L1[0][0]
__________________________________________________________________________________________________
Conv__B1_L3 (Conv1D)            (None, 104, 144)     55440       Conv__B1_L2[0][0]
__________________________________________________________________________________________________
MaxPool1D__B1_L3 (MaxPooling1D) (None, 52, 144)      0           Conv__B1_L3[0][0]
__________________________________________________________________________________________________
flatten (Flatten)               (None, 7488)         0           MaxPool1D__B1_L3[0][0]
__________________________________________________________________________________________________
FC1__B1_L1 (Dense)              (None, 512)          3834368     flatten[0][0]
__________________________________________________________________________________________________
FC1__B1_L2 (Dense)              (None, 2048)         1050624     FC1__B1_L1[0][0]
__________________________________________________________________________________________________
FC1__B1_L3 (Dense)              (None, 4608)         9441792     FC1__B1_L2[0][0]
__________________________________________________________________________________________________
FC1__B1_L4 (Dense)              (None, 8192)         37756928    FC1__B1_L3[0][0]
__________________________________________________________________________________________________
FC1__Dropout__B1_L4 (Dropout)   (None, 8192)         0           FC1__B1_L4[0][0]
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, 2)]          0
__________________________________________________________________________________________________
Concatenated_Layer (Concatenate (None, 8194)         0           FC1__Dropout__B1_L4[0][0]
                                                                 input_2[0][0]
__________________________________________________________________________________________________
FC2__B1_L1 (Dense)              (None, 256)          2097920     Concatenated_Layer[0][0]
__________________________________________________________________________________________________
FC2__B1_L2 (Dense)              (None, 1024)         263168      FC2__B1_L1[0][0]
__________________________________________________________________________________________________
FC2__Dropout__B1_L2 (Dropout)   (None, 1024)         0           FC2__B1_L2[0][0]
__________________________________________________________________________________________________
gravity (Dense)                 (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
c_o_ratio (Dense)               (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
metallicity (Dense)             (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
__________________________________________________________________________________________________
temperature (Dense)             (None, 1)            1025        FC2__Dropout__B1_L2[0][0]
==================================================================================================
Total params: 54,510,660
Trainable params: 54,510,660
Non-trainable params: 0
__________________________________________________________________________________________________
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">plot_model_loss</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;RandState=100: X:StandRow, y:StandCol - MinMax:StandCol, ToyCNNmodel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="ddaefbb8-bfd0-41f2-9b2a-d7048e532a17" data-root-id="p1001" style="display: contents;"></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
(function(root) {
  function embed_document(root) {
  const docs_json = {"5b1b8896-7582-4a56-9802-7d76c5265738":{"version":"3.2.1","title":"Bokeh Application","roots":[{"type":"object","name":"Figure","id":"p1001","attributes":{"width":1000,"height":300,"x_range":{"type":"object","name":"DataRange1d","id":"p1002"},"y_range":{"type":"object","name":"DataRange1d","id":"p1003"},"x_scale":{"type":"object","name":"LinearScale","id":"p1011"},"y_scale":{"type":"object","name":"LogScale","id":"p1012"},"title":{"type":"object","name":"Title","id":"p1004","attributes":{"text":"RandState=100: X:StandRow, y:StandCol - MinMax:StandCol, ToyCNNmodel","text_font_size":"14pt"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1036","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1030","attributes":{"selected":{"type":"object","name":"Selection","id":"p1031","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1032"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.2628032863140106,0.10128653049468994,0.08382060378789902]]]}}},"view":{"type":"object","name":"CDSView","id":"p1037","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1038"}}},"glyph":{"type":"object","name":"Line","id":"p1033","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1034","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1035","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1047","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1041","attributes":{"selected":{"type":"object","name":"Selection","id":"p1042","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1043"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.12168771028518677,0.08352407813072205,0.09182650595903397]]]}}},"view":{"type":"object","name":"CDSView","id":"p1048","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1049"}}},"glyph":{"type":"object","name":"Line","id":"p1044","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_width":2,"line_dash":[2,4]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1045","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_alpha":0.1,"line_width":2,"line_dash":[2,4]}},"muted_glyph":{"type":"object","name":"Line","id":"p1046","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#d62728","line_alpha":0.2,"line_width":2,"line_dash":[2,4]}}}},{"type":"object","name":"GlyphRenderer","id":"p1056","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1050","attributes":{"selected":{"type":"object","name":"Selection","id":"p1051","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1052"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.10362229496240616,0.027136078104376793,0.018552379682660103]]]}}},"view":{"type":"object","name":"CDSView","id":"p1057","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1058"}}},"glyph":{"type":"object","name":"Line","id":"p1053","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1054","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1055","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1066","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1060","attributes":{"selected":{"type":"object","name":"Selection","id":"p1061","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1062"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.04263933375477791,0.020807955414056778,0.026606818661093712]]]}}},"view":{"type":"object","name":"CDSView","id":"p1067","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1068"}}},"glyph":{"type":"object","name":"Line","id":"p1063","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_width":2,"line_dash":[2,4]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1064","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_alpha":0.1,"line_width":2,"line_dash":[2,4]}},"muted_glyph":{"type":"object","name":"Line","id":"p1065","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#ff7f0e","line_alpha":0.2,"line_width":2,"line_dash":[2,4]}}}},{"type":"object","name":"GlyphRenderer","id":"p1075","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1069","attributes":{"selected":{"type":"object","name":"Selection","id":"p1070","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1071"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.05651426687836647,0.017618834972381592,0.015128294005990028]]]}}},"view":{"type":"object","name":"CDSView","id":"p1076","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1077"}}},"glyph":{"type":"object","name":"Line","id":"p1072","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1073","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1074","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1085","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1079","attributes":{"selected":{"type":"object","name":"Selection","id":"p1080","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1081"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.017573721706867218,0.01211718562990427,0.013469154946506023]]]}}},"view":{"type":"object","name":"CDSView","id":"p1086","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1087"}}},"glyph":{"type":"object","name":"Line","id":"p1082","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_width":2,"line_dash":[2,4]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1083","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_alpha":0.1,"line_width":2,"line_dash":[2,4]}},"muted_glyph":{"type":"object","name":"Line","id":"p1084","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#2ca02c","line_alpha":0.2,"line_width":2,"line_dash":[2,4]}}}},{"type":"object","name":"GlyphRenderer","id":"p1094","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1088","attributes":{"selected":{"type":"object","name":"Selection","id":"p1089","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1090"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.0933263748884201,0.0536174476146698,0.04779960587620735]]]}}},"view":{"type":"object","name":"CDSView","id":"p1095","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1096"}}},"glyph":{"type":"object","name":"Line","id":"p1091","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1092","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1093","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1104","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1098","attributes":{"selected":{"type":"object","name":"Selection","id":"p1099","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1100"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.056223586201667786,0.04917609691619873,0.049481090158224106]]]}}},"view":{"type":"object","name":"CDSView","id":"p1105","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1106"}}},"glyph":{"type":"object","name":"Line","id":"p1101","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_width":2,"line_dash":[2,4]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1102","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_alpha":0.1,"line_width":2,"line_dash":[2,4]}},"muted_glyph":{"type":"object","name":"Line","id":"p1103","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#9467bd","line_alpha":0.2,"line_width":2,"line_dash":[2,4]}}}},{"type":"object","name":"GlyphRenderer","id":"p1113","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1107","attributes":{"selected":{"type":"object","name":"Selection","id":"p1108","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1109"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.00934035237878561,0.002914178417995572,0.0023403014056384563]]]}}},"view":{"type":"object","name":"CDSView","id":"p1114","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1115"}}},"glyph":{"type":"object","name":"Line","id":"p1110","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_width":2}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1111","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_alpha":0.1,"line_width":2}},"muted_glyph":{"type":"object","name":"Line","id":"p1112","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_alpha":0.2,"line_width":2}}}},{"type":"object","name":"GlyphRenderer","id":"p1123","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1117","attributes":{"selected":{"type":"object","name":"Selection","id":"p1118","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1119"},"data":{"type":"map","entries":[["x",[0,1,2]],["y",[0.005251061636954546,0.0014228340005502105,0.0022694156505167484]]]}}},"view":{"type":"object","name":"CDSView","id":"p1124","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1125"}}},"glyph":{"type":"object","name":"Line","id":"p1120","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_width":2,"line_dash":[2,4]}},"nonselection_glyph":{"type":"object","name":"Line","id":"p1121","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_alpha":0.1,"line_width":2,"line_dash":[2,4]}},"muted_glyph":{"type":"object","name":"Line","id":"p1122","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":"#8c564b","line_alpha":0.2,"line_width":2,"line_dash":[2,4]}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1010","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1023"},{"type":"object","name":"WheelZoomTool","id":"p1024"},{"type":"object","name":"BoxZoomTool","id":"p1025","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1026","attributes":{"syncable":false,"level":"overlay","visible":false,"left_units":"canvas","right_units":"canvas","bottom_units":"canvas","top_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1027"},{"type":"object","name":"ResetTool","id":"p1028"},{"type":"object","name":"HelpTool","id":"p1029"}]}},"left":[{"type":"object","name":"LogAxis","id":"p1018","attributes":{"ticker":{"type":"object","name":"LogTicker","id":"p1019","attributes":{"num_minor_ticks":10,"mantissas":[1,5]}},"formatter":{"type":"object","name":"LogTickFormatter","id":"p1020"},"axis_label":"Loss","axis_label_text_font_size":"12pt","major_label_policy":{"type":"object","name":"AllLabels","id":"p1021"},"major_label_text_font_size":"12pt"}}],"below":[{"type":"object","name":"LinearAxis","id":"p1013","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1014","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1015"},"axis_label":"Epochs","axis_label_text_font_size":"12pt","major_label_policy":{"type":"object","name":"AllLabels","id":"p1016"},"major_label_text_font_size":"12pt"}}],"center":[{"type":"object","name":"Grid","id":"p1017","attributes":{"axis":{"id":"p1013"}}},{"type":"object","name":"Grid","id":"p1022","attributes":{"dimension":1,"axis":{"id":"p1018"}}},{"type":"object","name":"Legend","id":"p1039","attributes":{"location":"bottom_left","background_fill_color":"white","background_fill_alpha":0.5,"items":[{"type":"object","name":"LegendItem","id":"p1040","attributes":{"label":{"type":"value","value":"Total loss"},"renderers":[{"id":"p1036"}]}},{"type":"object","name":"LegendItem","id":"p1059","attributes":{"label":{"type":"value","value":"gravity"},"renderers":[{"id":"p1056"}]}},{"type":"object","name":"LegendItem","id":"p1078","attributes":{"label":{"type":"value","value":"c_o_ratio"},"renderers":[{"id":"p1075"}]}},{"type":"object","name":"LegendItem","id":"p1097","attributes":{"label":{"type":"value","value":"metallicity"},"renderers":[{"id":"p1094"}]}},{"type":"object","name":"LegendItem","id":"p1116","attributes":{"label":{"type":"value","value":"temperature"},"renderers":[{"id":"p1113"}]}}]}}]}}]}};
  const render_items = [{"docid":"5b1b8896-7582-4a56-9802-7d76c5265738","roots":{"p1001":"ddaefbb8-bfd0-41f2-9b2a-d7048e532a17"},"root_ids":["p1001"]}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script></div>
</div>
<section id="Plot-Y-predicted-vs-Y_Actual:-Histogram-&amp;-Scatter-plot">
<h2>Plot Y predicted vs Y_Actual: Histogram &amp; Scatter plot<a class="headerlink" href="#Plot-Y-predicted-vs-Y_Actual:-Histogram-&-Scatter-plot" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">regression_report</span><span class="p">(</span>
        <span class="n">trained_model</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="p">,</span>

        <span class="n">Xtrain</span> <span class="o">=</span> <span class="p">[</span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_standardized_rowwise</span><span class="p">[::</span><span class="n">i</span><span class="p">],</span>
                  <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_train_standardized_columnwise</span><span class="p">[::</span><span class="n">i</span><span class="p">]],</span>

        <span class="n">Xtest</span>  <span class="o">=</span> <span class="p">[</span><span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_standardized_rowwise</span><span class="p">[::</span><span class="n">i</span><span class="p">],</span>
                  <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">X_test_standardized_columnwise</span><span class="p">[::</span><span class="n">i</span><span class="p">]],</span>

        <span class="n">ytrain</span> <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_train_standardized_columnwise</span><span class="p">[::</span><span class="n">i</span><span class="p">],</span>

        <span class="n">ytest</span>  <span class="o">=</span> <span class="n">build_cnn_regression</span><span class="o">.</span><span class="n">y_test_standardized_columnwise</span><span class="p">[::</span><span class="n">i</span><span class="p">],</span>

        <span class="n">target_i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>

        <span class="n">xy_top</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
        <span class="n">xy_bottom</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">],</span>
        <span class="n">print_results</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_51_0.png" src="../../_images/tutorials_store_Train_CNN_Model_51_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_51_1.png" src="../../_images/tutorials_store_Train_CNN_Model_51_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_51_2.png" src="../../_images/tutorials_store_Train_CNN_Model_51_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_store_Train_CNN_Model_51_3.png" src="../../_images/tutorials_store_Train_CNN_Model_51_3.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Ehsan (Sam) Gharib-Nezhad.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>